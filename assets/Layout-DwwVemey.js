import{v as j,o as e,t as o,a as l,w as v,O as g}from"./chunk-NL6KNZEE-D71spLCj.js";import{a as x,F as N,f as b}from"./index-C6LqSLaZ.js";import{u}from"./AuthContext-CpWodBBB.js";const y="/assets/Icon-CiQlCwQk.png";function k({name:t}){return e.jsx("div",{className:"w-10 h-10 flex items-center justify-center text-lg font-bold text-white",children:t[0].toUpperCase()})}function I(){j();const t=[{id:1,name:"Сервер 1",icon:null},{id:2,name:"Сервер 2",icon:null}];return e.jsxs("nav",{className:"flex flex-col items-center w-16 h-full bg-white/10 py-2 gap-2 border-r border-white/10 rounded-[8px]",children:[e.jsx(o,{to:"/me",className:"bg-white/10 w-12 h-12 rounded-[8px] flex items-center justify-center text-2xl font-bold hover:rounded-[16px] transition",title:"Speeks",children:e.jsx("img",{className:"w-full h-full rounded-[8px] hover:rounded-[16px] transition",src:y,alt:"Speeks"})}),e.jsx("span",{className:"h-[2px] rounded-full w-6/8 bg-white/50"}),t.map(s=>e.jsx(o,{to:`/me/server/${s.id}`,className:"bg-white/10 w-12 h-12 rounded-[8px] flex items-center justify-center text-xl mb-1 hover:rounded-[16px] transition",title:s.name,children:s.icon?e.jsx("img",{className:"w-full h-full rounded-[8px] hover:rounded-[16px] transition",src:s.icon,alt:s.name}):e.jsx(k,{name:s.name})},s.id))]})}function U(){const{accessToken:t,user:s}=u(),[i,d]=l.useState([]),[h,_]=l.useState({}),[c,m]=l.useState({});l.useEffect(()=>{t&&x.get("http://127.0.0.1:8000/auth/friends",{headers:{Authorization:`Bearer ${t}`}}).then(r=>d(r.data)).catch(()=>d([]))},[t]),l.useEffect(()=>{if(!(s!=null&&s.id)||i.length===0||!t)return;i.map(n=>n.requester_id===s.id?n.addressee_id:n.requester_id).forEach(n=>{f(n)})},[i,s,t]);const p=s==null?void 0:s.id,f=async r=>{if(!c[r])try{const n=await x.get(`http://127.0.0.1:8000/auth/user/${r}/username`);m(a=>({...a,[r]:n.data.username}))}catch{}};return e.jsxs("div",{className:"flex-1 p-[8px] gap-[8px] flex flex-col bg-white/10 overflow-auto min-w-[220px] max-w-[260px] rounded-[8px]",children:[e.jsx("button",{className:"w-full h-[32px] bg-white/10 rounded-[8px] cursor-pointer text-white/50",children:"Найти беседу"}),e.jsx("span",{className:"h-[2px] rounded-full w-full bg-white/50"}),e.jsx("div",{className:"w-full flex",children:e.jsxs(o,{className:"rounded-[8px] transition hover:bg-white/10 w-full p-[8px] text-white/50",to:"/me",children:[e.jsx(N,{icon:b,className:"mr-[4px]"})," Друзья"]})}),e.jsx("span",{className:"h-[2px] rounded-full w-full bg-white/50"}),e.jsx("ul",{className:"space-y-2",children:i.map(r=>{let n=r.requester_id===p?r.addressee_id:r.requester_id;const a=h[n],w=`http://127.0.0.1:8000/auth/avatars/${n}`;return e.jsx("li",{children:e.jsxs(o,{to:`/me/${n}`,className:"flex items-center gap-[8px] px-[8px] py-[4px] rounded-[8px] hover:bg-white/10 transition",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0",children:e.jsx("img",{className:"w-10 h-10 rounded-full object-cover",src:w,alt:c[n]||n})}),e.jsx("div",{children:e.jsx("div",{className:"font-semibold",children:(a==null?void 0:a.username)||c[n]||n})})]})},r.id)})})]})}function S(){const{user:t,logout:s}=u();return e.jsxs("div",{className:"p-4 flex items-center gap-2 bg-white/10 rounded-[8px]",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:t==null?void 0:t.username}),e.jsx("div",{className:"text-xs text-white/50",children:(t==null?void 0:t.email)||"no email"})]}),e.jsx("button",{className:"text-xs text-red-400 hover:underline",onClick:s,children:"Выйти"})]})}const q=v(function(){return e.jsxs("div",{className:"flex h-screen w-screen bg-black text-white p-2 gap-2",children:[e.jsxs("div",{className:"flex flex-col h-full gap-2 min-w-[280px] max-w-[340px]",children:[e.jsxs("div",{className:"flex flex-row flex-1 gap-2 h-full",children:[e.jsx(I,{}),e.jsx(U,{})]}),e.jsx(S,{})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx(g,{})})]})});export{q as default};
