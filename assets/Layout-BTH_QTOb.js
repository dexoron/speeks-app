import{v,o as e,t as o,a as l,w as g,O as N}from"./chunk-NL6KNZEE-D71spLCj.js";import{a as u,F as b,f as y}from"./index-C6LqSLaZ.js";import{u as m,a as d}from"./AuthContext-z9X0gYbi.js";const k="/assets/Icon-CiQlCwQk.png";function I({name:t}){return e.jsx("div",{className:"w-10 h-10 flex items-center justify-center text-lg font-bold text-white",children:t[0].toUpperCase()})}function $(){v();const t=[{id:1,name:"Сервер 1",icon:null},{id:2,name:"Сервер 2",icon:null}];return e.jsxs("nav",{className:"flex flex-col items-center w-16 h-full bg-white/10 py-2 gap-2 border-r border-white/10 rounded-[8px]",children:[e.jsx(o,{to:"/me",className:"bg-white/10 w-12 h-12 rounded-[8px] flex items-center justify-center text-2xl font-bold hover:rounded-[16px] transition",title:"Speeks",children:e.jsx("img",{className:"w-full h-full rounded-[8px] hover:rounded-[16px] transition",src:k,alt:"Speeks"})}),e.jsx("span",{className:"h-[2px] rounded-full w-6/8 bg-white/50"}),t.map(s=>e.jsx(o,{to:`/me/server/${s.id}`,className:"bg-white/10 w-12 h-12 rounded-[8px] flex items-center justify-center text-xl mb-1 hover:rounded-[16px] transition",title:s.name,children:s.icon?e.jsx("img",{className:"w-full h-full rounded-[8px] hover:rounded-[16px] transition",src:s.icon,alt:s.name}):e.jsx(I,{name:s.name})},s.id))]})}function S(){const{accessToken:t,user:s}=m(),[i,x]=l.useState([]),[h,_]=l.useState({}),[c,f]=l.useState({});l.useEffect(()=>{t&&u.get(`${d}/auth/friends`,{headers:{Authorization:`Bearer ${t}`}}).then(n=>x(n.data)).catch(()=>x([]))},[t]),l.useEffect(()=>{if(!(s!=null&&s.id)||i.length===0||!t)return;i.map(a=>a.requester_id===s.id?a.addressee_id:a.requester_id).forEach(a=>{w(a)})},[i,s,t]);const p=s==null?void 0:s.id,w=async n=>{if(!c[n])try{const a=await u.get(`${d}/auth/user/${n}/username`);f(r=>({...r,[n]:a.data.username}))}catch{}};return e.jsxs("div",{className:"flex-1 p-[8px] gap-[8px] flex flex-col bg-white/10 overflow-auto min-w-[220px] max-w-[260px] rounded-[8px]",children:[e.jsx("button",{className:"w-full h-[32px] bg-white/10 rounded-[8px] cursor-pointer text-white/50",children:"Найти беседу"}),e.jsx("span",{className:"h-[2px] rounded-full w-full bg-white/50"}),e.jsx("div",{className:"w-full flex",children:e.jsxs(o,{className:"rounded-[8px] transition hover:bg-white/10 w-full p-[8px] text-white/50",to:"/me",children:[e.jsx(b,{icon:y,className:"mr-[4px]"})," Друзья"]})}),e.jsx("span",{className:"h-[2px] rounded-full w-full bg-white/50"}),e.jsx("ul",{className:"space-y-2",children:i.map(n=>{let a=n.requester_id===p?n.addressee_id:n.requester_id;const r=h[a],j=`${d}/auth/avatars/${a}`;return e.jsx("li",{children:e.jsxs(o,{to:`/me/${a}`,className:"flex items-center gap-[8px] px-[8px] py-[4px] rounded-[8px] hover:bg-white/10 transition",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0",children:e.jsx("img",{className:"w-10 h-10 rounded-full object-cover",src:j,alt:c[a]||a})}),e.jsx("div",{children:e.jsx("div",{className:"font-semibold",children:(r==null?void 0:r.username)||c[a]||a})})]})},n.id)})})]})}function U(){const{user:t,logout:s}=m();return e.jsxs("div",{className:"p-4 flex items-center gap-2 bg-white/10 rounded-[8px]",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:t==null?void 0:t.username}),e.jsx("div",{className:"text-xs text-white/50",children:(t==null?void 0:t.email)||"no email"})]}),e.jsx("button",{className:"text-xs text-red-400 hover:underline",onClick:s,children:"Выйти"})]})}const q=g(function(){return e.jsxs("div",{className:"flex h-screen w-screen bg-black text-white p-2 gap-2",children:[e.jsxs("div",{className:"flex flex-col h-full gap-2 min-w-[280px] max-w-[340px]",children:[e.jsxs("div",{className:"flex flex-row flex-1 gap-2 h-full",children:[e.jsx($,{}),e.jsx(S,{})]}),e.jsx(U,{})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx(N,{})})]})});export{q as default};
