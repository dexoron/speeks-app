import{w as f,v as g,a as j,o as e,t as b}from"./chunk-NL6KNZEE-D71spLCj.js";import{u as N,a as i}from"./AuthContext-z9X0gYbi.js";const S=f(function(){const{login:d}=N(),m=g(),[r,s]=j.useState("");async function u(n){n.preventDefault(),s("");const h=n.currentTarget,o=new FormData(h),x=o.get("username"),p=o.get("password");try{const t=new URLSearchParams;t.append("username",x),t.append("password",p);const l=await fetch(`${i}/auth/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t.toString()});if(!l.ok)throw new Error("Неверные данные");const a=await l.json(),c=await fetch(`${i}/auth/me`,{headers:{Authorization:`Bearer ${a.access_token}`}});if(!c.ok){s("Ошибка авторизации: не удалось получить профиль пользователя.");return}const w=await c.json();d(a.access_token,a.refresh_token,w),m("/me")}catch{s("Ошибка входа. Проверьте данные.")}}return e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-3xl font-bold text-center mb-2",children:"Войти в аккаунт"}),e.jsxs("form",{className:"flex flex-col gap-2",onSubmit:u,children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"username",className:"text-white/50",children:"Имя пользователя"}),e.jsx("input",{type:"text",id:"username",name:"username",required:!0,className:"w-full h-12 rounded-lg bg-white/10 px-2"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"password",className:" text-white/50",children:"Пароль"}),e.jsx("input",{type:"password",id:"password",name:"password",required:!0,className:"w-full h-12 rounded-lg bg-white/10 px-2"}),e.jsx("a",{className:"text-sky-500",href:"#",children:"Забыли пароль?"})]}),e.jsx("button",{type:"submit",className:"w-full h-12 bg-black/75 font-semibold rounded-lg hover:bg-black",children:"Войти"}),e.jsxs("span",{className:"text-white/50 text-right",children:["Нет аккаунта? ",e.jsx(b,{className:"text-sky-500",to:"/auth/register",children:"Зарегестрироваться"})]})]}),r&&e.jsx("div",{className:"text-red-500 text-center mt-2",children:r})]})});export{S as default};
